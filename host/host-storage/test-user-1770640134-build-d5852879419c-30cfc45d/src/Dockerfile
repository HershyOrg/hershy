FROM golang:1.24-alpine AS builder\n\nWORKDIR /build\n\n# Install build dependencies\nRUN apk add --no-cache git ca-certificates\n\n# Copy go.mod, go.sum and source\nCOPY go.mod go.sum ./\nCOPY main.go .\n\n# Download dependencies (hersh from Go proxy)\nRUN go mod download\n\n# Build\nRUN CGO_ENABLED=0 GOOS=linux go build -o simple-counter main.go\n\n# Runtime stage\nFROM alpine:latest\n\nRUN apk add --no-cache ca-certificates\n\nWORKDIR /app\n\n# Copy binary\nCOPY --from=builder /build/simple-counter /app/\n\n# Create state directory\nRUN mkdir -p /state\n\n# WatcherAPI runs on :8080\nEXPOSE 8080\n\nCMD [\"/app/simple-counter\"]\n